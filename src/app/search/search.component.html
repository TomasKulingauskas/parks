<div class="container-fluid">
  <div class="row">
    <div class="col-sm-12 mt-2 mb-2 d-xl-flex justify-content-around">
      <div class="text-center">
        <img class="img-fluid title-image" src="/assets/kaunas-logo.png">
      </div>
      <div class="text-center row justify-content-center align-self-center">
        <h4 class="title text-uppercase">Kauno parkai ir sporto aikštės</h4>
      </div>
      <div class="header-icons">
        <img class="img-fluid header-icon-tree" src="/assets/Tree-icon128.png">
        <img class="img-fluid header-icon-ball" src="/assets/Soccer-Ball-icon64.png">
        <img class="img-fluid header-icon-tree" src="/assets/Tree-icon128.png">
        <img class="img-fluid header-icon-ball" src="/assets/Misc-Games-icon64.png">
        <img class="img-fluid header-icon-tree" src="/assets/Tree-icon128.png">
        <img class="img-fluid header-icon-ball" src="/assets/Volleyball-icon64.png">
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-12 search">
      <form (ngSubmit)="onFormSubmit(form)" class="pt-1" #form="ngForm">
        <label class="mr-2">Ko ieškosiu:</label>
        <span class="form-group places">
          <input type="radio" id="customRadio1" name="selectType" [checked]="parksChecked"
                 [disabled]="!(online$ | async)" [(ngModel)]="radio" value="Parkai">
          <label class="mr-1" for="customRadio1">Parkai</label>
          <input type="radio" id="customRadio2" name="selectType" [disabled]="!(online$ | async)" [(ngModel)]="radio"
                 value="Sporto aikštės">
          <label for="customRadio2">Sporto aikštės</label>
        </span>
        <div class="form-group subdistricts">
          <label class="mr-2">Kur ieškosiu:</label>
          <div *ngFor="let option of checkboxOptions; let idx = index"
               class="align-items-center d-inline-block custom-control custom-checkbox mr-2">
            <input type="checkbox"
                   [disabled]="!(online$ | async)"
                   class="custom-control-input"
                   id="{{idx}}"
                   name="{{option.name}}"
                   [value]="option.checked"
                   ngModel>
            <label class="custom-control-label mb-2 mb-md-0" for="{{idx}}">{{option.name}}</label>
          </div>
          <div class="d-inline-block">
            <button class="btn btn-primary mr-2" type="submit" [disabled]="!(online$ | async)"
                    (click)="showSpinner = true">Paieška
            </button>
            <button class="btn btn-warning" (click)="resetForm(form)" type="button">Išvalyti</button>
          </div>
        </div>
      </form>
      <div class="input-field mb-2 mb-md-0">
        <label class="search-label" for="park">Ieškoti parko</label>
        <input [disabled]="!(online$ | async)" id="park" list="list" placeholder="Parko pavadinimas" type="text"
               class="validate filter-input"
               [(ngModel)]=query (keyup)="searchFilter(form)">
        <div class="suggestions d-block position-absolute border border-dark text-center"
             *ngIf="filteredList.length > 0">
          <div id="list" *ngFor="let item of filteredList">
            <a href="#" class="suggested-item d-block" (click)="select(item)">{{item.name}}</a>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-sm-12 position-relative">
      <app-loading-spinner *ngIf="showSpinner"></app-loading-spinner>
      <div class="card position-absolute" *ngIf="markerClicked">
        <div class="card-header text-center">
          <div class="row">
            <div class="col-8">
              <h5 style="display: inline">{{item.name}}</h5>
              <img src="/assets/Tree-icon32.png" *ngIf="parkFlag">
              <img src="/assets/basketball-icon.png" *ngIf="item.name === 'Krepšinio aikštė'">
              <img src="/assets/soccer-ball-icon.png" *ngIf="item.name === 'Futbolo aikštė'">
            </div>
            <div class="col-4">
              <a href="#" style="text-decoration: none" class="btn-sm btn-success" (click)="markerClicked = false">Uždaryti</a>
            </div>
          </div>
        </div>
        <div class="card-body">
          <div class="row">
            <div class="col-8">
              <i class="fas fa-map-marker-alt"></i>
              <p style="display: inline" class="card-title">{{item.subdistrict}}</p>
              <div>
                <i class="fas fa-info-circle"></i>
                <p style="display: inline" class="card-text">{{distance}} km atstumas nuo jūsų buvimo vietos</p>
              </div>
            </div>
            <div class="col-4">
              <p>Dalintis su draugais</p>
              <a href=""
                 id="link" (click)="fbShareLink(item.latitude, item.longitude)"
                 target="_blank"><i class="fab fa-facebook fa-3x" aria-hidden="true"></i></a>
            </div>
          </div>
        </div>
      </div>
      <div class="map">
        <agm-map #nElement (click)="handleClick($event)"
                 mapTypeId="terrain"
                 [zoom]="zoom"
                 [latitude]="latitude"
                 [longitude]="longitude">
          <agm-marker [latitude]="userLatitude"
                      [longitude]="userLongitude"
                      (mouseOver)="onMouseOver(infoWindow)"
                      (mouseOut)="onMouseOut(infoWindow)">
            <agm-info-window #infoWindow>
              <p>You are here!</p>
            </agm-info-window>
          </agm-marker>
          <agm-marker *ngFor="let park of filteredParks"
                      [latitude]="park.latitude"
                      [longitude]="park.longitude"
                      [iconUrl]="'/assets/Tree-icon32.png'"
                      (mouseOver)="onMouseOver(infoWindow)"
                      (mouseOut)="onMouseOut(infoWindow)"
                      (markerClick)="onMarkerClick(park, park.latitude, park.longitude)">
            <agm-info-window #infoWindow>
              <h5>{{park.name}}</h5>
              <p>Click for details</p>
            </agm-info-window>
          </agm-marker>
          <agm-marker *ngFor="let sport of sports"
                      [latitude]="sport.latitude"
                      [longitude]="sport.longitude"
                      [iconUrl]="getSportIcon(sport.name)"
                      (mouseOver)="onMouseOver(infoWindow)"
                      (mouseOut)="onMouseOut(infoWindow)"
                      (markerClick)="onMarkerClick(sport, sport.latitude, sport.longitude)">
            <agm-info-window #infoWindow>
              <h5>{{sport.name}}</h5>
              <p>Click for details</p>
            </agm-info-window>
          </agm-marker>
        </agm-map>
      </div>
    </div>
  </div>
</div>

<!---Error modal-->
<ng-template #content let-c="close" let-d="dismiss">
  <div class="modal-header">
    <h4 class="modal-title">Klaida!</h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body">
    <p *ngIf="errorMessage" [innerHtml]="errorMessage"></p>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-outline-dark" (click)="c('Close click')">Close</button>
  </div>
</ng-template>
